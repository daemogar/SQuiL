//HintName: SQuiLBaseDataContext.g.cs
// <auto-generated />

#nullable enable

namespace SQuiL;

using Microsoft.Data.SqlClient;
using Microsoft.Extensions.Configuration;

public abstract class SQuiLBaseDataContext(IConfiguration Configuration)
{
	public virtual string SettingName { get; } = "SQuiLDatabase";

	protected string EnvironmentName { get; } = Configuration.GetSection("EnvironmentName")?.Value
		?? Environment.GetEnvironmentVariable(Configuration.GetSection("EnvironmentVariable")?.Value ?? "ASPNETCORE_ENVIRONMENT")
		?? "Development";
		
	private SqlConnectionStringBuilder? builder;
	protected SqlConnectionStringBuilder ConnectionStringBuilder
	{
		get
		{
			if (builder is not null) return builder;

			return builder = new SqlConnectionStringBuilder(Configuration.GetConnectionString(SettingName)
				?? throw new Exception($"Cannot find a connection string in the appsettings for {SettingName}."));
		}
	}
}